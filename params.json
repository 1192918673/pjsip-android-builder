{
  "name": "PJSIP Android Builder",
  "tagline": "Complete Android build environment for PJSIP with OpenSSL, OpenH264, libyuv and G.729",
  "body": "## Build matrix\r\n<b>Using Android API 18 (it's the default when you checkout the project and in the vagrant base box):</b>\r\n\r\n| Library \\ Builds for | armeabi | armeabi-v7a | x86 | mips | arm64-v8a  | x86_64 | mips64 |\r\n|----------------------|---------|-------------|-----|------|------------|--------|--------|\r\n| [PJSIP 2.4.5](https://trac.pjsip.org/repos/browser/pjproject/tags/2.4.5)          |    X    |      X      |  X  |   X  |          |      |      |\r\n| [LibYUV r1580](https://github.com/illuspas/libyuv-android)         |    X    |      X      |  X  |     |           |      |      |\r\n| [G.729](https://github.com/gotev/pjsip-android-builder/tree/master/g729_patch)                |    X    |      X      |  X  |   X  |           |       |       |\r\n| [OpenSSL 1.0.2g](https://www.openssl.org/source/)       |    X    |      X      |  X  |   X  |           |       |        |\r\n| [OpenH264 1.0.0](https://github.com/cisco/openh264/releases/tag/v1.0.0)       |    X    |      X      |  X  |   X  |            |        |        |\r\nIf you want to compile LibYUV for mips, check why it has been disabled in [#12](https://github.com/gotev/pjsip-android-builder/issues/12).\r\n\r\n<b>Using Android API 21+:</b>\r\n\r\n| Library \\ Builds for | armeabi | armeabi-v7a | x86 | mips | arm64-v8a  | x86_64 | mips64 |\r\n|----------------------|---------|-------------|-----|------|------------|--------|--------|\r\n| [PJSIP 2.4.5](https://trac.pjsip.org/repos/browser/pjproject/tags/2.4.5)          |    X    |      X      |  X  |   X  |      X     |    X   |    X   |\r\n| [LibYUV r1580](https://github.com/illuspas/libyuv-android)         |    X    |      X      |  X  |   X  |      X     |    X   |    X   |\r\n| [G.729](https://github.com/gotev/pjsip-android-builder/tree/master/g729_patch)                |    X    |      X      |  X  |   X  |      X     |    X   |    X   |\r\n| [OpenSSL 1.0.2g](https://www.openssl.org/source/)       |    X    |      X      |  X  |   X  |      X     |    X   |        |\r\n| [OpenH264 1.0.0](https://github.com/cisco/openh264/releases/tag/v1.0.0)       |    X    |      X      |  X  |   X  |            |        |        |\r\n\r\nOpenSSL and OpenH264 have problems with 64 bit archs, as you can see from the build compatibility matrix. Check [#2](https://github.com/gotev/pjsip-android-builder/issues/2) and [#8](https://github.com/gotev/pjsip-android-builder/issues/8) for further reference. 64 bit builds are supported starting from Android API 21+, so if you compile using older Android APIs, you can do that only for: `armeabi`, `armeabi-v7a`, `x86` and `mips`. \r\n\r\n## Purpose\r\nI needed an easily replicable build system to build PJSIP http://www.pjsip.org/ native library with NDK for Android. So, I created a Linux virtual machine and wrote some scripts to download, install all the requirements needed to make it a complete build environment and some automated build scripts.\r\nIf you want to contribute, your help is really appreciated :)\r\n\r\n## Setup\r\nYou have three options available. The first two require that you have [vagrant](https://www.vagrantup.com/) installed on your system. The first option is the easiest and also the fastest, but may be not the most updated. The second one lets you create the base box exactly as I create it, and the third one is the slowest, as you have to install everything from the base OS and download tons of stuff. You choose.\r\n\r\n### With ready to use vagrant base box\r\nYou can find it [here](https://atlas.hashicorp.com/gotev/boxes/pjsip-android-builder/).\r\n```\r\nvagrant init gotev/pjsip-android-builder; vagrant up --provider virtualbox\r\n```\r\nthen you can SSH into the VM and build PJSIP:\r\n```\r\n./build\r\n```\r\n\r\n### Build the vagrant box from scratch\r\n```\r\ngit clone https://github.com/gotev/pjsip-android-builder\r\ncd pjsip-android-builder; vagrant up\r\n```\r\nThis will setup a full Ubuntu Server 14.04.3 LTS from scratch with everything that's needed to compile PJSIP. This will take some time, as there are many things which has to be downloaded and installed, so relax or do some other thing while waiting. Be aware that you may encounter errors in the process, due to newer versions of the libraries being released and the versions used in `config.conf` not being available anymore. If that happens, check which are the new versions, update `config.conf` and retry from scratch. There may be also other errors due to compilation issues when newer compiler versions and tools are released...and that's a whole new story! After plenty of output, if everything is ok you will see:\r\n```\r\nThe build system is ready! Execute: ./build to build PJSIP :)\r\n```\r\nthen you can SSH into the VM and build PJSIP:\r\n```\r\nvagrant ssh\r\ncd /pjsip-android-builder; ./build\r\n```\r\n\r\n### Manual setup\r\nFirst, you need a virtualization system. There are plenty of choices out there. Choose the one that you prefer (VirtualBox, vmWare, Vagrant, you name it). I'm supposing that you know what a virtual machine is and how to setup your environment to be able to run virtual machines. So, let's begin :)\r\n\r\n1. Download the latest Ubuntu Server ISO (I've chosen 14.04.3 LTS): http://www.ubuntu.com/download/server <br>I've chosen this distro because it has a good support for the applications that we need and it's kept updated. In the future, support to other distributions can be added as well, with your help :)\r\n2. Create a new virtual machine with at least 1GB RAM and 20GB virtual hard drive. Add as many RAM and processors as you can, so the compilation process will be faster.\r\n3. Install Ubuntu Server\r\n4. SSH into your newly installed VM and execute the following commands, which will install all the required packages and files to be able to build PJSIP. This will take some time, as there are many things which has to be downloaded and installed, so relax or do some other thing while waiting<br>\r\n```\r\nsudo apt-get install -y git\r\ngit clone https://github.com/alexbbb/pjsip-android-builder\r\ncd pjsip-android-builder\r\n./prepare-build-system\r\n```\r\n\r\n## Build PJSIP\r\nAfter you have successfully set up your VM, to build PJSIP, go into pjsip-android-builder and execute:\r\n```\r\n./build\r\n```\r\nWhen everything goes well, you will see an output like this:\r\n```\r\nClear final build folder ...\r\nCreating config site file for Android ...\r\nCompile PJSIP for arch armeabi ...\r\nCompile PJSUA for arch armeabi ...\r\nCopying PJSUA .so library to final build directory ...\r\nCopying OpenH264 .so library to final build directory ...\r\nCopying libyuv .so library to final build directory ...\r\nCompile PJSIP for arch armeabi-v7a ...\r\nCompile PJSUA for arch armeabi-v7a ...\r\nCopying PJSUA .so library to final build directory ...\r\nCopying OpenH264 .so library to final build directory ...\r\nCopying libyuv .so library to final build directory ...\r\nCompile PJSIP for arch x86 ...\r\nCompile PJSUA for arch x86 ...\r\nCopying PJSUA .so library to final build directory ...\r\nCopying OpenH264 .so library to final build directory ...\r\nCopying libyuv .so library to final build directory ...\r\nCompile PJSIP for arch x86_64 ...\r\nCompile PJSUA for arch x86_64 ...\r\nCopying PJSUA .so library to final build directory ...\r\nCopying libyuv .so library to final build directory ...\r\nCompile PJSIP for arch arm64-v8a ...\r\nCompile PJSUA for arch arm64-v8a ...\r\nCopying PJSUA .so library to final build directory ...\r\nCopying libyuv .so library to final build directory ...\r\nCopying PJSUA2 java bindings to final build directory ...\r\nFinished! Check the generated output in /home/user/pjsip-android-builder/pjsip-build\r\n```\r\n\r\nThe script is going to create a new folder named <b>pjsip-build</b> organized as follows:\r\n```\r\npjsip-build\r\n |-- logs/  contains the full build log for each target architecture\r\n |-- lib/   contains the compiled libraries for each target architecture\r\n |-- src/   contains PJSUA Java wrapper to work with the library\r\n```\r\nIf something goes wrong during the compilation of a particular target architecture, the main script will be terminated and you can see the full log in `./pjsip-build/logs/<arch>.log`. So for example if there's an error for <b>x86</b>, you can see the full log in `./pjsip-build/logs/x86.log`\r\n\r\n## Build with G.729 codec\r\nPlease read [G.729 codec disclaimer](https://github.com/gotev/pjsip-android-builder/blob/master/g729_patch/README.md)!\r\n\r\nUse `./build-with-g729` script insted of `./build`.\r\n\r\n## Configuration\r\nIt's possible to configure library versions and build settings by editing the <b>config.conf</b> file. Please read the comments in the file for more details.\r\n\r\n### Switch from Android API 18 to Android API 21\r\nBy default Android API 18 are used. If you want to compile with Android API 21, change the following in `config.conf` and leave the rest unchanged:\r\n```\r\nTARGET_ARCHS=(\"armeabi\" \"armeabi-v7a\" \"x86\" \"mips\")\r\nTARGET_ANDROID_API=21\r\nSETUP_PACKAGES=0\r\nDOWNLOAD_NDK=0\r\nDOWNLOAD_SDK=0\r\nDOWNLOAD_ANDROID_APIS=0\r\nDOWNLOAD_PJSIP=1\r\nDOWNLOAD_SWIG=0\r\n```\r\nThen:\r\n```\r\n./prepare-build-system; ./build\r\n```\r\nAfter recent changes from 1.0.0 to 1.1 I've not had the necessary time to fully test build with API 21, so if you encounter errors, file an issue with all the details or a pull request with the solution (which is the best option).\r\n\r\n## Build only OpenSSL\r\nThis project has separate independent script to build only OpenSSL library.\r\n```\r\nUsage:\r\n./openssl-build <ANDROID_NDK_PATH> <OPENSSL_SOURCES_PATH> <ANDROID_TARGET_API> \\\r\n                <ANDROID_TARGET_ABI> <GCC_VERSION> <OUTPUT_PATH>\r\n\r\nSupported target ABIs: armeabi, armeabi-v7a, x86, x86_64, arm64-v8a\r\n\r\nExample using GCC 4.8, NDK 10e, OpenSSL 1.0.2d and Android API 21 for armeabi-v7a.\r\n./openssl-build /home/user/android-ndk-r10e /home/user/openssl-1.0.2d 21 \\\r\n                armeabi-v7a 4.8 /home/user/output/armeabi-v7a\r\n```\r\nIf you want to leverage on the <b>config.conf</b> properties and build OpenSSL for every configured target arch, you can use the following helper script:\r\n```\r\n./openssl-build-target-archs\r\n```\r\nWhen everything goes well, you will see an output like this:\r\n```\r\nBuilding OpenSSL for target arch armeabi ...\r\nBuilding OpenSSL for target arch armeabi-v7a ...\r\nBuilding OpenSSL for target arch x86 ...\r\nBuilding OpenSSL for target arch x86_64 ...\r\nBuilding OpenSSL for target arch arm64-v8a ...\r\nFinished building OpenSSL! Check output folder: /home/user/pjsip-android-builder/openssl-build-output\r\n```\r\nThe script is going to create a new folder named <b>openssl-build-output</b> organized as follows:\r\n```\r\nopenssl-build-output\r\n |-- logs/  contains the full build log for each target architecture\r\n |-- libs/  contains the compiled libraries for each target architecture\r\n```\r\nIf something goes wrong during the compilation of a particular target architecture, the main script will be terminated and you can see the full log in `./openssl-build-output/logs/<arch>.log`. So for example if there's an error for <b>x86</b>, you can see the full log in `./openssl-build-output/logs/x86.log`\r\n\r\n## License\r\n\r\n    Copyright (C) 2015-2016 Aleksandar Gotev\r\n\r\n    Licensed under the Apache License, Version 2.0 (the \"License\");\r\n    you may not use this file except in compliance with the License.\r\n    You may obtain a copy of the License at\r\n\r\n       http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    Unless required by applicable law or agreed to in writing, software\r\n    distributed under the License is distributed on an \"AS IS\" BASIS,\r\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n    See the License for the specific language governing permissions and\r\n    limitations under the License.\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}